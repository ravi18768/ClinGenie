const languages = [
  {
    name: "Czech",
    code: "cz",
    flag: "https://flagcdn.com/w40/cz.png",
    audio:
      "https://callfluent.com/wp-content/themes/callfluent2023/assets/marketing/audio_samples/cs_sample_speach.mp3",
  },
  {
    name: "Danish",
    code: "da-DK",
    flag: "https://flagcdn.com/w40/dk.png",
    audio:
      "https://callfluent.com/wp-content/themes/callfluent2023/assets/marketing/audio_samples/da-DK_sample_speach.mp3",
  },
  {
    name: "Dutch",
    code: "nl",
    flag: "https://flagcdn.com/w40/nl.png",
    audio:
      "https://callfluent.com/wp-content/themes/callfluent2023/assets/marketing/audio_samples/nl_sample_speach.mp3",
  },
  {
    name: "English",
    code: "en-GB",
    flag: "https://flagcdn.com/w40/gb.png",
    audio:
      "https://callfluent.com/wp-content/themes/callfluent2023/assets/marketing/audio_samples/en_sample_speach.mp3",
  },
  {
    name: "French",
    code: "fr",
    flag: "https://flagcdn.com/w40/fr.png",
    audio:
      "https://callfluent.com/wp-content/themes/callfluent2023/assets/marketing/audio_samples/fr_sample_speach.mp3",
  },
  {
    name: "German",
    code: "de",
    flag: "https://flagcdn.com/w40/de.png",
    audio:
      "https://callfluent.com/wp-content/themes/callfluent2023/assets/marketing/audio_samples/de_sample_speach.mp3",
  },
  {
    name: "Greek",
    code: "el",
    flag: "https://flagcdn.com/w40/gr.png",
    audio:
      "https://callfluent.com/wp-content/themes/callfluent2023/assets/marketing/audio_samples/gr_sample_speach.mp3",
  },
  {
    name: "Hindi",
    code: "hi",
    flag: "https://flagcdn.com/w40/in.png",
    audio:
      "https://callfluent.com/wp-content/themes/callfluent2023/assets/marketing/audio_samples/hi_sample_speach.mp3",
  },
  {
    name: "Italian",
    code: "it",
    flag: "https://flagcdn.com/w40/it.png",
    audio:
      "https://callfluent.com/wp-content/themes/callfluent2023/assets/marketing/audio_samples/id_sample_speach.mp3",
  },
  {
    name: "Japanese",
    code: "jp",
    flag: "https://flagcdn.com/w40/jp.png",
    audio:
      "https://callfluent.com/wp-content/themes/callfluent2023/assets/marketing/audio_samples/it_sample_speach.mp3",
  },
  {
    name: "Korean",
    code: "ko",
    flag: "https://flagcdn.com/w40/kr.png",
    audio:
      "https://callfluent.com/wp-content/themes/callfluent2023/assets/marketing/audio_samples/ko_sample_speach.mp3",
  },
  {
    name: "Indonesian",
    code: "id",
    flag: "https://flagcdn.com/w40/id.png",
    audio:
      "https://callfluent.com/wp-content/themes/callfluent2023/assets/marketing/audio_samples/pl_sample_speach.mp3",
  },
  {
    name: "Norwegian",
    code: "no",
    flag: "https://flagcdn.com/w40/no.png",
    audio:
      "https://callfluent.com/wp-content/themes/callfluent2023/assets/marketing/audio_samples/no_sample_speach.mp3",
  },
  {
    name: "Polish",
    code: "pl",
    flag: "https://flagcdn.com/w40/pl.png",
    audio:
      "https://callfluent.com/wp-content/themes/callfluent2023/assets/marketing/audio_samples/pl_sample_speach.mp3",
  },
  {
    name: "Portuguese",
    code: "pt",
    flag: "https://flagcdn.com/w40/pt.png",
    audio:
      "https://callfluent.com/wp-content/themes/callfluent2023/assets/marketing/audio_samples/pt_sample_speach.mp3",
  },
  {
    name: "Russian",
    code: "ru",
    flag: "https://flagcdn.com/w40/ru.png",
    audio:
      "https://callfluent.com/wp-content/themes/callfluent2023/assets/marketing/audio_samples/ru_sample_speach.mp3",
  },
  {
    name: "Spanish",
    code: "es",
    flag: "https://flagcdn.com/w40/es.png",
    audio:
      "https://callfluent.com/wp-content/themes/callfluent2023/assets/marketing/audio_samples/es_sample_speach.mp3",
  },
  {
    name: "Swedish",
    code: "sv",
    flag: "https://flagcdn.com/w40/se.png",
    audio:
      "https://callfluent.com/wp-content/themes/callfluent2023/assets/marketing/audio_samples/sv_sample_speach.mp3",
  },
  {
    name: "Turkish",
    code: "tr",
    flag: "https://flagcdn.com/w40/tr.png",
    audio:
      "https://callfluent.com/wp-content/themes/callfluent2023/assets/marketing/audio_samples/sv_sample_speach.mp3",
  },
  {
    name: "Ukrainian",
    code: "uk",
    flag: "https://flagcdn.com/w40/ua.png",
    audio:
      "https://callfluent.com/wp-content/themes/callfluent2023/assets/marketing/audio_samples/uk_sample_speach.mp3",
  },
];

// Array of random texts for the button
const randomTexts = [
  "Better trial outcomes",
  "Better trial outcomes",
  "Better trial outcomes",
  "Better trial outcomes",
  "Better trial outcomes",
];

// Array of random gradient colors
const gradientColors = [
  "linear-gradient(to right, #ff7e5f, #feb47b)",
  "linear-gradient(to right, #6a11cb, #2575fc)",
  "linear-gradient(to right, #11998e, #38ef7d)",
  "linear-gradient(to right, #fc466b, #3f5efb)",
  "linear-gradient(to right, #ff512f, #dd2476)",
  "linear-gradient(to right, #1a2a6c, #b21f1f, #fdbb2d)",
];
const voiceArr = [
  {
    profile_pic: "./assets/images/profile1.png",
    name: "Study Recruitment",
    audio:
      "https://callfluent.com/wp-content/themes/callfluent2023/assets/marketing/audio_samples/da-DK_sample_speach.mp3",
    description:
      "Prescreening Facilitates participant onboarding by screening and recruiting for studies.",
  },
  {
    profile_pic: "./assets/images/profile2.png",
    name: "Smart Qualification",
    audio:
      "https://callfluent.com/wp-content/themes/callfluent2023/assets/marketing/audio_samples/cs_sample_speach.mp3",
    description:
      "Uses AI to qualify patients effectively based on predefined criteria.",
  },
  {
    profile_pic: "./assets/images/profile1.png",
    name: "Appointment Management",
    audio:
      "https://callfluent.com/wp-content/themes/callfluent2023/assets/marketing/audio_samples/nl_sample_speach.mp3",
    description: "Schedules, reschedules, or cancels appointments efficiently.",
  },
  {
    profile_pic: "./assets/images/profile2.png",
    name: "Appointment Confirmation",
    audio:
      "https://callfluent.com/wp-content/themes/callfluent2023/assets/marketing/audio_samples/fr_sample_speach.mp3",
    description:
      "Confirms appointments with participants via automated processes.",
  },
  {
    profile_pic: "./assets/images/profile1.png",
    name: "Multilingual Support",
    audio:
      "https://callfluent.com/wp-content/themes/callfluent2023/assets/marketing/audio_samples/da-DK_sample_speach.mp3",
    description:
      "Provides support in multiple languages to ensure inclusivity and accessibility.",
  },
  {
    profile_pic: "./assets/images/profile2.png",
    name: "Leave Voicemails",
    audio:
      "https://callfluent.com/wp-content/themes/callfluent2023/assets/marketing/audio_samples/cs_sample_speach.mp3",
    description:
      "Allows automated or manual voicemail drops for important updates.",
  },
  {
    profile_pic: "./assets/images/profile1.png",
    name: "Smooth Human Transfer",
    audio:
      "https://callfluent.com/wp-content/themes/callfluent2023/assets/marketing/audio_samples/nl_sample_speach.mp3",
    description: "Transfers calls seamlessly to a human agent when necessary.",
  },
  {
    profile_pic: "./assets/images/profile2.png",
    name: "Inbound Management",
    audio:
      "https://callfluent.com/wp-content/themes/callfluent2023/assets/marketing/audio_samples/fr_sample_speach.mp3",
    description:
      "Handles inbound calls with AI to manage queries and provide accurate responses.",
  },
];

// Function to create a typewriter effect with a blinking cursor
function typewriterEffect(element, text, delay, callback) {
  let currentText = "";
  let currentIndex = 0;
  let cursorVisible = true; // Toggle cursor visibility
  const cursor = "|"; // Cursor character

  // Function to toggle cursor visibility
  function toggleCursor() {
    cursorVisible = !cursorVisible;
    element.textContent = currentText + (cursorVisible ? cursor : "");
  }

  // Typing the current text
  function updateText() {
    if (currentIndex < text.length) {
      currentText += text[currentIndex];
      element.textContent = currentText + cursor; // Append cursor
      currentIndex++;
      setTimeout(updateText, delay);
    } else {
      clearInterval(cursorInterval); // Stop blinking cursor
      element.textContent = currentText; // Final text without cursor
      if (callback) callback(); // Call the callback when done
    }
  }

  const cursorInterval = setInterval(toggleCursor, 100); // Cursor blinks every 100ms
  updateText(); // Start the typing effect
}

// Function to update the text content randomly after previous typing is done
function updateRandomText() {
  const randomIndex = Math.floor(Math.random() * randomTexts.length);
  const randomGradient =
    gradientColors[Math.floor(Math.random() * gradientColors.length)];
  const newText = randomTexts[randomIndex];
  const btn1Element = document.querySelector(".random-text");

  // Apply random gradient as text color
  // btn1Element.style.backgroundImage = randomGradient;

  typewriterEffect(btn1Element, newText, 20, function () {
    setTimeout(updateRandomText, 2000); // Wait 2 seconds before next text
  });
}

// Start the first random text update
updateRandomText();

// audio player

const currentPlayingState = {
  currentPlaying: null,
  currentButton: null,
};

function initializeWaveSurfer(
  item,
  index,
  container,
  btn,
  currentPlayingState
) {
  const randomNumbers = Array.from(
    { length: 60 },
    () => Math.floor(Math.random() * 9) + 2
  );
  const playButton = document.getElementById(`${btn}`);
  let isPlaying = false;

  // Create a new WaveSurfer instance
  const wavesurfer = WaveSurfer.create({
    container: `#${container}`,
    waveColor: "#fff",
    progressColor: "#33c275",
    back: "#000",
    barWidth: 2,
    barGap: 5,
    barRadius: 2,
    barHeight: 0.6,
    responsive: true,
    url: item?.audio,
    peaks: [randomNumbers], // Add peaks to waveform
  });

  // Add event listener to play/pause button
  playButton.addEventListener("click", () => {
    // Pause any currently playing audio
    if (
      currentPlayingState.currentPlaying &&
      currentPlayingState.currentPlaying !== wavesurfer
    ) {
      currentPlayingState.currentPlaying.pause();
      document
        .querySelector(".play-btn span.playing")
        ?.classList.replace("playing", "paused");
      playButton.querySelector("span").textContent = "▶";
      playButton.querySelector("span").style.cssText = "font-size:36px";
    }

    // Toggle play/pause for this instance
    isPlaying ? wavesurfer.pause() : wavesurfer.play();
    playButton.querySelector("span").textContent = isPlaying ? "▶" : "⏸";
    playButton.querySelector("span").style.cssText = isPlaying
      ? "font-size:36px"
      : "font-size:54px";
    isPlaying = !isPlaying;
    currentPlayingState.currentPlaying = wavesurfer;
    currentPlayingState.currentButton = null;
  });

  wavesurfer.on("pause", () => {
    playButton.querySelector("span").textContent = "▶";
    playButton.querySelector("span").style.cssText = "font-size:36px";
    isPlaying = false;
  });

  // Reset state when playback finishes
  wavesurfer.on("finish", () => {
    playButton.querySelector("span").textContent = "▶";
    playButton.querySelector("span").style.cssText = "font-size:36px";
    isPlaying = false;
  });
}

const slider = document.querySelector(".voice-card-container");
let currentIndex = 0;
let currentPlaying = null;
function renderSlider() {
  voiceArr.forEach((item, index) => {
    const slide = document.createElement("div");
    slide.classList.add("voice-card");
    slide.innerHTML = `<div class="profile">
                        <img src=${item?.profile_pic} alt="profile" />
                        <div class="details">
                            <h2>${item?.name}</h2>
                            <p>${item?.description}</p>
                        </div>
                    </div>
                    <div class="audio-wave">
                        <div id="waveform${index}" style="width:100%"></div>
                        <div class="play">
                            <button class="play-btn" id="playButton${index}">
                                <span>▶</span>
                            </button>
                        </div>
                    </div>`;
    slider.appendChild(slide);

    //audio wave
    initializeWaveSurfer(
      item,
      index,
      `waveform${index}`,
      `playButton${index}`,
      currentPlayingState
    );
  });
}
renderSlider();

// toggle option
const toggleOptions = document.querySelectorAll(".toggle-option");
toggleOptions.forEach((option) => {
  option.addEventListener("click", () => {
    toggleOptions.forEach((o) => o.classList.remove("active"));
    option.classList.add("active");
  });
});

const faqListArray = [
  {
    title: "How does Autocalls work as an AI phone call platform?",
    description:
      "Autocalls AI automates customer interactions with a customizable AI voice agent that can scale. It manages outbound (proactive outreach) and inbound (responsive) calls for tasks like lead qualification, customer support, and appointment scheduling. With no-code tools and flexible  deployment options, Autocalls enhances engagement and streamlines communication using the latest technology.",
  },
  {
    title: "I use a phone system. Can I use ClinGenie.ai?",
    description:
      "Autocalls AI automates customer interactions with a customizable AI voice agent that can scale. It manages outbound (proactive outreach) and inbound (responsive) calls for tasks like lead qualification, customer support, and appointment scheduling. With no-code tools and flexible  deployment options, Autocalls enhances engagement and streamlines communication using the latest technology.",
  },
  {
    title: "Is expertise required for quality prompts?",
    description:
      "Autocalls AI automates customer interactions with a customizable AI voice agent that can scale. It manages outbound (proactive outreach) and inbound (responsive) calls for tasks like lead qualification, customer support, and appointment scheduling. With no-code tools and flexible  deployment options, Autocalls enhances engagement and streamlines communication using the latest technology.",
  },
  {
    title: "Can I set up automations with your service?",
    description:
      "Autocalls AI automates customer interactions with a customizable AI voice agent that can scale. It manages outbound (proactive outreach) and inbound (responsive) calls for tasks like lead qualification, customer support, and appointment scheduling. With no-code tools and flexible  deployment options, Autocalls enhances engagement and streamlines communication using the latest technology.",
  },
  {
    title: "Can I set up automations with your service?",
    description:
      "Autocalls AI automates customer interactions with a customizable AI voice agent that can scale. It manages outbound (proactive outreach) and inbound (responsive) calls for tasks like lead qualification, customer support, and appointment scheduling. With no-code tools and flexible  deployment options, Autocalls enhances engagement and streamlines communication using the latest technology.",
  },
  {
    title: "How does the AI load with my company information?",
    description:
      "Autocalls AI automates customer interactions with a customizable AI voice agent that can scale. It manages outbound (proactive outreach) and inbound (responsive) calls for tasks like lead qualification, customer support, and appointment scheduling. With no-code tools and flexible  deployment options, Autocalls enhances engagement and streamlines communication using the latest technology.",
  },
  {
    title: "How do I get a phone number from you?",
    description:
      "Autocalls AI automates customer interactions with a customizable AI voice agent that can scale. It manages outbound (proactive outreach) and inbound (responsive) calls for tasks like lead qualification, customer support, and appointment scheduling. With no-code tools and flexible  deployment options, Autocalls enhances engagement and streamlines communication using the latest technology.",
  },
];
const faqBlock = document.getElementById("faq-block");

// Create a list
const faqList = document.createElement("ul");
faqList.style.listStyle = "none";
faqList.style.padding = "0";

// Variable to keep track of the currently open description
let openDescription = null;
let openParentDiv = null;
let openToggleButton = null;
let openTitle = null;

// Loop through the faqListArray to create list items dynamically
faqListArray.forEach((feature) => {
  // Create the parent div
  const parentDiv = document.createElement("div");
  parentDiv.style.borderRadius = "15px";
  parentDiv.style.transition = "all 0.3s ease";
  parentDiv.style.padding = "5px";
  parentDiv.style.marginBottom = "10px";

  // Create the list item
  const li = document.createElement("li");
  li.style.position = "relative";
  li.style.cursor = "pointer";

  // Create the title paragraph
  const title = document.createElement("p");
  title.textContent = feature.title;
  title.style.cssText = `
    background-color: #F8F8F8;
    padding: 20px 50px 20px 20px;
    border-radius: 12px;
    margin: 0;
    cursor: pointer;
    transition: all 0.3s ease;
  `;

  // Create a description paragraph
  const description = document.createElement("p");
  description.classList.add("description");
  description.textContent = feature.description;
  description.style.cssText = `
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.6s ease, opacity 0.3s ease;
    margin-top: 10px;
    padding: 0 20px;
    opacity: 0;
  `;

  // Create the toggle button
  const toggleButton = document.createElement("span");
  toggleButton.textContent = "+";
  toggleButton.style.cssText = `
    position: absolute;
    right: 20px;
    top: 50%;
    transform: translateY(-50%);
    cursor: pointer;
    font-size: 30px;
    color: #B4BBC5;
    transition: all 0.3s ease;
  `;

  const resetStyles = (element) => {
    if (!element) return;

    if (element === openTitle) {
      element.style.cssText = `
        background-color: #F8F8F8;
        padding: 20px 50px 20px 20px;
        border-radius: 12px;
        margin: 0;
        cursor: pointer;
        transition: all 0.3s ease;
        color: black;
      `;
    } else if (element === openDescription) {
      element.style.cssText = `
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.6s ease, opacity 0.3s ease;
        margin-top: 10px;
        padding: 0 20px;
        opacity: 0;
      `;
    } else if (element === openToggleButton) {
      element.style.cssText = `
        position: absolute;
        right: 20px;
        top: 50%;
        transform: translateY(-50%);
        cursor: pointer;
        font-size: 30px;
        color: #B4BBC5;
        transition: all 0.3s ease;
      `;
      element.textContent = "+";
    }

    if (openParentDiv) {
      openParentDiv.style.backgroundColor = "";
    }
  };

  const toggleDescription = () => {
    const isOpen = openDescription === description;

    // Reset previously open elements
    resetStyles(openTitle);
    resetStyles(openDescription);
    resetStyles(openToggleButton);

    if (!isOpen) {
      // Open the new description
      description.style.maxHeight = `${description.scrollHeight}px`;
      description.style.opacity = "1";

      title.style.cssText = `
        background-color: transparent;
        padding: 20px 50px 20px 20px;
        border-radius: 12px;
        margin: 0;
        cursor: pointer;
        transition: all 0.3s ease;
        color: white;
      `;

      description.style.color = "white";

      toggleButton.style.cssText = `
        position: absolute;
        right: 20px;
        top: 30px;
        transform: translateY(-50%);
        cursor: pointer;
        font-size: 35px;
        color: white;
        transition: all 0.3s ease;
      `;
      toggleButton.textContent = "×";

      parentDiv.style.backgroundColor = "#4caf50";

      // Update the references
      openDescription = description;
      openParentDiv = parentDiv;
      openToggleButton = toggleButton;
      openTitle = title;
    } else {
      // Reset all references if the same item is toggled
      openDescription = null;
      openParentDiv = null;
      openToggleButton = null;
      openTitle = null;
    }
  };

  // Add click event listeners
  const handleClick = (e) => {
    e.stopPropagation();
    toggleDescription();
  };

  toggleButton.addEventListener("click", handleClick);
  title.addEventListener("click", handleClick);

  // Append elements
  li.appendChild(title);
  li.appendChild(toggleButton);
  li.appendChild(description);
  parentDiv.appendChild(li);
  faqList.appendChild(parentDiv);
});

// Append the FAQ list to the FAQ block container
faqBlock.appendChild(faqList);

// List of countries with their flag emojis
fetch("./assets/JSON/countryData.json")
  .then((response) => {
    if (!response.ok) {
      throw new Error("Network response was not ok " + response.statusText);
    }
    return response.json();
  })
  .then((data) => {
    populateCustomDropdown(data);
  })
  .catch((error) => {
    console.error("Error fetching the country data:", error);
  });

function populateCustomDropdown(countries) {
  const countrySelect = document.getElementById("country-select");
  const selectedCountryInfo = document.getElementById("selected-country-info");

  // Populate dropdown
  countries.forEach((country) => {
    const option = document.createElement("option");
    option.value = country.code;
    option.innerHTML = `${country.flag} ${country.name}`;
    countrySelect.appendChild(option);
  });

  // Event listener for selection
  countrySelect.addEventListener("change", (e) => {
    const selectedCode = e.target.value;
    const selectedCountry = countries.find(
      (country) => country.code === selectedCode
    );

    if (selectedCountry) {
      selectedCountryInfo.innerHTML = `
            <h2>Selected Country</h2>
            <p>
                <strong>Name:</strong> ${selectedCountry.flag}<br>
                <strong>Country Code:</strong> ${selectedCountry.code}
            </p>
        `;
    } else {
      selectedCountryInfo.innerHTML = "";
    }
  });
}

// hamburger-menu event
document.getElementById("showButton").addEventListener("click", function () {
  const targetDiv = document.getElementById("targetDiv");
  const showButton = document.getElementById("showButton");
  if (targetDiv.classList.contains("hidden")) {
    targetDiv.classList.remove("hidden");
    targetDiv.classList.add("visible");
    showButton.textContent = "X";
  } else {
    targetDiv.classList.remove("visible");
    targetDiv.classList.add("hidden");
    showButton.textContent = "☰";
  }
});

// Data for right-inbound container
const rightInboundOptions = [
  { imgSrc: "/assets/images/Sales.png", text: "Appointments" },
  { imgSrc: "/assets/images/Sales.png", text: "Product support" },
  { imgSrc: "/assets/images/Sales.png", text: "Appointments" },
  { imgSrc: "/assets/images/Sales.png", text: "Customer support" },
];

// Data for left-inbound container
const leftInboundOptions = [
  { imgSrc: "/assets/images/Sales.png", text: "Sales" },
  {
    imgSrc: "/assets/images/Surveys and feedback.png",
    text: "Surveys and feedback",
  },
  {
    imgSrc: "/assets/images/Lead pre qualification.png",
    text: "Lead prequalification",
  },
  {
    imgSrc: "/assets/images/Confrmations and follow-up.png",
    text: "Confirmations and follow-up",
  },
];

// Function to generate dynamic options
const renderDynamicOptions = (containerId, options) => {
  const container = document.getElementById(containerId);
  if (!container) return;

  // Clear existing content
  container.innerHTML = "";

  // Create HTML for each option
  options.forEach((option) => {
    const salesCol = document.createElement("div");
    salesCol.className = "salesCol";
    salesCol.innerHTML = `
      <img src="${option.imgSrc}" class="salesImg" alt="${option.text}" />
      <div class="salesTxt">${option.text}</div>
    `;
    container.appendChild(salesCol);
  });
};

// Tab switching functionality
const initTabs = () => {
  const tabConfig = {
    outbound: {
      button: document.getElementById("outbound-btn"),
      content: document.getElementById("outbound-content"),
    },
    inbound: {
      button: document.getElementById("inbound-btn"),
      content: document.getElementById("inbound-content"),
    },
  };

  // Add click handlers to tab buttons
  Object.entries(tabConfig).forEach(([tabName, { button, content }]) => {
    button?.addEventListener("click", () => {
      Object.values(tabConfig).forEach(({ button, content }) => {
        button.classList.remove("active");
        content.classList.remove("active");
      });
      button.classList.add("active");
      content.classList.add("active");
    });
  });

  // Set default active tab
  tabConfig.outbound.button.classList.add("active");
  tabConfig.outbound.content.classList.add("active");
};

// Initialize all functionality when DOM is loaded
document.addEventListener("DOMContentLoaded", () => {
  initTabs();
  renderDynamicOptions("right-inbound", rightInboundOptions);
  renderDynamicOptions("left-inbound", leftInboundOptions);
});
